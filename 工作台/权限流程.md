2. 权限分配规则：
   - 特殊处理人优先判断:
     * 当节点配置了特殊处理人时，直接使用特殊处理人作为处理人
     * 跳过后续权限判断流程
   - 无特殊处理人时的权限判断流程:
     * 用户权限维度:
       + 根据节点权限码加上产品代码获取对应的有权限的业务人员
       + 如果产品代码不存在则不控产品维度
     * 机构维度:
       + 如果节点配置中配置了机构且机构范围为"只判断配置机构":
         - 根据节点配置的机构获取机构人员
       + 如果节点配置中配置了机构且机构范围为"合并判断":
         - 获取节点配置机构和发起人机构的并集人员
       + 如果节点机构没有配置:
         - 直接取发起人机构获取人员
     * 取用户权限维度和机构维度的交集作为最终处理人候选
   - 其他规则:
     * 维护节点判断处理人自动剔除当前操作人
     * 其他节点分配处理人无需剔除当前操作人
     * 分配符合条件的处理人

```mermaid
graph TD
    Start[权限分配开始] --> CheckSpecial{是否配置特殊处理人?};

    CheckSpecial -->|是| UseSpecial[直接使用特殊处理人] --> End[分配完成];

    subgraph "无特殊处理人时的判断流程"
        CheckSpecial -->|否| ParallelStart( ); style ParallelStart fill:#fff,stroke:#fff

        ParallelStart --> GetUserPerms[用户维度: 根据节点权限码获取业务人员];
        GetUserPerms --> UserSet((用户权限人员集合));

        ParallelStart --> CheckOrgConfig{机构维度: 节点是否配置机构?};
        CheckOrgConfig -->|否| GetInitiatorOrgUsers[取发起人机构获取人员];
        CheckOrgConfig -->|是| CheckOrgScope{机构范围是?};
        CheckOrgScope -->|"只判断配置机构"| GetConfigOrgUsers[根据节点配置机构获取人员];
        CheckOrgScope -->|"合并判断"| GetMergedOrgUsers[获取节点配置机构和发起人机构的并集人员];
        GetInitiatorOrgUsers --> OrgSet((机构维度人员集合));
        GetConfigOrgUsers --> OrgSet;
        GetMergedOrgUsers --> OrgSet;

        UserSet --> FindIntersection((取交集));
        OrgSet --> FindIntersection;
        FindIntersection --> CandidateSet[最终处理人候选];
    end

    subgraph "其他规则"
        CandidateSet --> CheckNodeType{节点类型是?};
        CheckNodeType -->|维护节点| FilterCurrentUser[剔除当前操作人];
        CheckNodeType -->|其他节点| AssignFinal[分配符合条件的处理人];
        FilterCurrentUser --> AssignFinal;
    end

    AssignFinal --> End;
```